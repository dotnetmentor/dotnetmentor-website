/* 
  trueskill 0.0.2 
  https://www.npmjs.com/package/trueskill

  Distributed under Apache 2.0 License
  https://github.com/freethenation/node-trueskill/blob/master/LICENSE.txt
*/

!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.trueskill=t()}}(function(){return function t(n,r,e){function i(a,o){if(!r[a]){if(!n[a]){var s="function"==typeof require&&require;if(!o&&s)return s(a,!0);if(u)return u(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var f=r[a]={exports:{}};n[a][0].call(f.exports,function(t){var r=n[a][1][t];return i(r?r:t)},f,f.exports,t,n,r,e)}return r[a].exports}for(var u="function"==typeof require&&require,a=0;a<e.length;a++)i(e[a]);return i}({1:[function(t,n,r){!function(t){var n=function(t){var n=Math.abs(t),r=1/(1+n/2),e=r*Math.exp(-n*n-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+.17087277*r)))))))));return t>=0?e:2-e},r=function(t){if(t>=2)return-100;if(t<=0)return 100;for(var r=t<1?t:2-t,e=Math.sqrt(-2*Math.log(r/2)),i=-.70711*((2.30753+.27061*e)/(1+e*(.99229+.04481*e))-e),u=0;u<2;u++){var a=n(i)-r;i+=a/(1.1283791670955126*Math.exp(-(i*i))-i*a)}return t<1?i:-i},e=function(t,n){return u(n/t,1/t)},i=function(t,n){if(n<=0)throw new Error("Variance must be > 0 (but was "+n+")");this.mean=t,this.variance=n,this.standardDeviation=Math.sqrt(n)};i.prototype.pdf=function(t){var n=this.standardDeviation*Math.sqrt(2*Math.PI),r=Math.exp(-Math.pow(t-this.mean,2)/(2*this.variance));return r/n},i.prototype.cdf=function(t){return.5*n(-(t-this.mean)/(this.standardDeviation*Math.sqrt(2)))},i.prototype.add=function(t){return u(this.mean+t.mean,this.variance+t.variance)},i.prototype.sub=function(t){return u(this.mean-t.mean,this.variance+t.variance)},i.prototype.scale=function(t){return u(this.mean*t,this.variance*t*t)},i.prototype.mul=function(t){if("number"==typeof t)return this.scale(t);var n=1/this.variance,r=1/t.variance;return e(n+r,n*this.mean+r*t.mean)},i.prototype.div=function(t){if("number"==typeof t)return this.scale(1/t);var n=1/this.variance,r=1/t.variance;return e(n-r,n*this.mean-r*t.mean)},i.prototype.ppf=function(t){return this.mean-this.standardDeviation*Math.sqrt(2)*r(2*t)};var u=function(t,n){return new i(t,n)};t(u)}("undefined"==typeof r?function(t){this.gaussian=t}:function(t){n.exports=t})},{}],2:[function(t,n,r){(function(){var n,e,i,u,a,o,s,p,f,h,l,c,v,d,g,m,y,w,M,_,U,b,k,x,S,q,N,V,T,G,D,E,I,A={}.hasOwnProperty,O=function(t,n){function r(){this.constructor=t}for(var e in n)A.call(n,e)&&(t[e]=n[e]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};D=Math.sqrt,V=Math.pow,x=function(t){return t.length},T=function(t){var n;return function(){n=[];for(var r=0;0<=t?r<t:r>t;0<=t?r++:r--)n.push(r);return n}.apply(this)},G=function(t,n,r){var e,i,u;for(i=0,u=t.length;i<u;i++)e=t[i],r=n(r,e);return r},E=function(t){return G(t,function(t,n){return t+n},0)},S=function(t,n){var r,e,i,u;for(u=[],e=0,i=t.length;e<i;e++)r=t[e],u.push(n(r));return u},I=function(t){var n,r,e,i;return r=G(function(){var r;r=[];for(n in t)e=t[n],r.push(e);return r}(),function(t,n){return Math.min(t,n.length)},Number.MAX_VALUE),S(function(){i=[];for(var t=0;0<=r?t<r:t>r;0<=r?t++:t--)i.push(t);return i}.apply(this),function(n){var r,e,i;r={};for(e in t)i=t[e],r[e]=i[n];return r})},b=function(){var t;return t=-1,function(){return t++,t}}(),q=t("free-gaussian"),q=q(0,1),N=function(){return q.pdf.apply(q,arguments)},U=function(){return q.cdf.apply(q,arguments)},k=function(){return q.ppf.apply(q,arguments)},w=function(t,n){return N(t-n)/U(t-n)},_=function(t,n){return w(t,n)*(w(t,n)+t-n)},y=function(t,n){return(N(-n-t)-N(n-t))/(U(n-t)-U(-n-t))},M=function(t,n){return V(y(t,n),2)+((n-t)*N(n-t)+(n+t)*N(n+t))/(U(n-t)-U(-n-t))},p=function(){function t(t){if(null==t&&(t={}),void 0!==t.pi?(this.pi=t.pi,this.tau=t.tau):void 0!==t.mu?(this.pi=V(t.sigma,-2),this.tau=this.pi*t.mu):(this.pi=0,this.tau=0),isNaN(this.pi)||isNaN(this.tau))throw new Error("Gaussian parms can not be NaN")}return t.prototype.MuSigma=function(){return 0===this.pi?[0,1/0]:[this.tau/this.pi,D(1/this.pi)]},t.prototype.mul=function(n){return new t({pi:this.pi+n.pi,tau:this.tau+n.tau})},t.prototype.div=function(n){return new t({pi:this.pi-n.pi,tau:this.tau-n.tau})},t}(),m=function(){function t(){this.value=new p,this.factors={}}return t.prototype.AttachFactor=function(t){return this.factors[t]=new p},t.prototype.UpdateMessage=function(t,n){var r;return r=this.factors[t],this.value=this.value.div(r).mul(n),this.factors[t]=n},t.prototype.UpdateValue=function(t,n){var r;return r=this.factors[t],this.factors[t]=n.mul(r).div(this.value),this.value=n},t.prototype.GetMessage=function(t){return this.factors[t]},t}(),o=function(){function t(t){var n,r,e;for(this.id=b(),this.variables=t,r=0,e=t.length;r<e;r++)n=t[r],n.AttachFactor(this)}return t.prototype.toString=function(){return"Factor_"+this.id},t}(),c=function(t){function n(t,r){n.__super__.constructor.call(this,[t]),this.param=r}return O(n,t),n.prototype.Start=function(){return this.variables[0].UpdateValue(this,this.param)},n}(o),l=function(t){function n(t,r,e){n.__super__.constructor.call(this,[t,r]),this.mean=t,this.value=r,this.variance=e}return O(n,t),n.prototype.UpdateValue=function(){var t,n,r;return r=this.mean.value,n=this.mean.GetMessage(this),t=1/(1+this.variance*(r.pi-n.pi)),this.value.UpdateMessage(this,new p({pi:t*(r.pi-n.pi),tau:t*(r.tau-n.tau)}))},n.prototype.UpdateMean=function(){var t,n,r;return r=this.value.value,n=this.value.GetMessage(this),t=1/(1+this.variance*(r.pi-n.pi)),this.mean.UpdateMessage(this,new p({pi:t*(r.pi-n.pi),tau:t*(r.tau-n.tau)}))},n}(o),d=function(t){function n(t,r,e){if(x(r)!==x(e))throw new Error("assert error");this.sum=t,this.terms=r,this.coeffs=e,n.__super__.constructor.call(this,[t].concat(r))}return O(n,t),n.prototype._InternalUpdate=function(t,n,r,e){var i,u,a;u=S(T(x(e)),function(t){return V(e[t],2)/(n[t].pi-r[t].pi)}),u=1/E(u),a=u*E(function(){var t,u,a,o;for(a=T(x(e)),o=[],t=0,u=a.length;t<u;t++)i=a[t],o.push(e[i]*(n[i].tau-r[i].tau)/(n[i].pi-r[i].pi));return o}()),t.UpdateMessage(this,new p({pi:u,tau:a}))},n.prototype.UpdateSum=function(){var t,n,r,e;e=function(){var t,n,e,i;for(e=this.terms,i=[],t=0,n=e.length;t<n;t++)r=e[t],i.push(r.value);return i}.call(this),n=function(){var t,n,e,i;for(e=this.terms,i=[],t=0,n=e.length;t<n;t++)r=e[t],i.push(r.GetMessage(this));return i}.call(this),t=this.coeffs,this._InternalUpdate(this.sum,e,n,t)},n.prototype.UpdateTerm=function(t){var n,r,e,i,u,a;return r=this.coeffs,n=function(){var n,e,u,a;for(u=T(x(r)),a=[],n=0,e=u.length;n<e;n++)i=u[n],i!==t&&a.push(-r[i]/r[t]);return a}(),n.splice(t,0,1/r[t]),u=this.terms.slice(0),u[t]=this.sum,a=function(){var t,n,r;for(r=[],t=0,n=u.length;t<n;t++)i=u[t],r.push(i.value);return r}(),e=function(){var t,n,r;for(r=[],t=0,n=u.length;t<n;t++)i=u[t],r.push(i.GetMessage(this));return r}.call(this),this._InternalUpdate(this.terms[t],a,e,n)},n}(o),g=function(t){function n(t,r,e,i){n.__super__.constructor.call(this,[t]),this.var=t,this.V=r,this.W=e,this.epsilon=i}return O(n,t),n.prototype.Update=function(){var t,n,r,e,i,u,a,o,s;return s=this.var.value,u=this.var.GetMessage(this),e=s.pi-u.pi,i=s.tau-u.tau,o=D(e),r=[i/o,this.epsilon*o],t=this.V.apply(this,r),n=this.W.apply(this,r),a=new p({pi:e/(1-n),tau:(i+o*t)/(1-n)}),this.var.UpdateValue(this,a)},n}(o),u=function(t,n,r){return null==r&&(r=2),2*U(t/(D(r)*n))-1},i=function(t,n,r){return null==r&&(r=2),k((t+1)/2)*D(r)*n},f=25,h=f/3,e=null,a=null,s=null,v=function(t,n,r,u){return null==t&&(t=null),null==n&&(n=null),null==r&&(r=null),null==u&&(u=null),e=null===t?h/2:t,null===n?(null===r&&(r=.1),a=i(r,e)):a=n,s=null===u?h/100:u},v(),n=function(t){var n,r,i,u,o,f,h,v,U,b,k,x,S,q,N,G,D,E,A,O,F,P,W,j,C,L,X,z,B,H,J,K,Q,R;for(t=t.slice(0),t.sort(function(t,n){return t.rank-n.rank}),U=function(){var n,r,e;for(e=[],n=0,r=t.length;n<r;n++)u=t[n],e.push(new m);return e}(),f=function(){var n,r,e;for(e=[],n=0,r=t.length;n<r;n++)u=t[n],e.push(new m);return e}(),x=function(){var n,r,e;for(e=[],n=0,r=t.length;n<r;n++)u=t[n],e.push(new m);return e}(),n=function(){var n,r,e,i;for(e=t.slice(0,-1),i=[],n=0,r=e.length;n<r;n++)u=e[n],i.push(new m);return i}(),h=function(){var n,r,e,u;for(e=I({s:U,pl:t}),u=[],n=0,r=e.length;n<r;n++)i=e[n],u.push(new c(i.s,new p({mu:i.pl.skill[0],sigma:i.pl.skill[1]+s})));return u}(),v=function(){var t,n,r,u;for(r=I({s:U,p:f}),u=[],t=0,n=r.length;t<n;t++)i=r[t],u.push(new l(i.s,i.p,V(e,2)));return u}(),o=function(){var t,n,r,e;for(r=I({p:f,t:x}),e=[],t=0,n=r.length;t<n;t++)i=r[t],e.push(new d(i.t,[i.p],[1]));return e}(),b=function(){var t,r,e,u;for(e=I({d:n,t1:x.slice(0,-1),t2:x.slice(1)}),u=[],t=0,r=e.length;t<r;t++)i=e[t],u.push(new d(i.d,[i.t1,i.t2],[1,-1]));return u}(),k=function(){var r,e,u,o;for(u=I({d:n,pl1:t.slice(0,-1),pl2:t.slice(1)}),o=[],r=0,e=u.length;r<e;r++)i=u[r],o.push(new g(i.d,i.pl1.rank===i.pl2.rank?y:w,i.pl1.rank===i.pl2.rank?M:_,a));return o}(),S=0,D=h.length;S<D;S++)r=h[S],r.Start();for(q=0,E=v.length;q<E;q++)r=v[q],r.UpdateValue();for(N=0,A=o.length;N<A;N++)r=o[N],r.UpdateSum();for(Q=T(5),G=0,O=Q.length;G<O;G++){for(i=Q[G],X=0,F=b.length;X<F;X++)r=b[X],r.UpdateSum();for(z=0,P=k.length;z<P;z++)r=k[z],r.Update();for(B=0,W=b.length;B<W;B++)r=b[B],r.UpdateTerm(0),r.UpdateTerm(1)}for(H=0,j=o.length;H<j;H++)r=o[H],r.UpdateTerm(0);for(J=0,C=v.length;J<C;J++)r=v[J],r.UpdateMean();for(R=I({s:U,pl:t}),K=0,L=R.length;K<L;K++)i=R[K],i.pl.skill=i.s.value.MuSigma()},r.AdjustPlayers=n,r.SetParameters=v,r.SetInitialMu=function(t){return f=t},r.SetInitialSigma=function(t){return h=t}}).call(this)},{"free-gaussian":1}],3:[function(t,n,r){(function(){var r,e,i;r=t("free-gaussian"),i=t("./portedTrueskill"),n.exports=i,e=function(t){return new r(t[0],t[1])},n.exports.ChanceOfWinning=function(t,n){"The chance that trueskill assigns to player1 winning vs player2";return t=e(t),n=e(n),1-t.sub(n).cdf(0)}}).call(this)},{"./portedTrueskill":2,"free-gaussian":1}]},{},[3])(3)});
